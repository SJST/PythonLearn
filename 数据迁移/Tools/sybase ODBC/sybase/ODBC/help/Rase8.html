<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">

<html xmlns="http://www.w3.org/1999/xhtml" xml:lang="en" lang="en">
 <head>
  <meta http-equiv="Content-Type" content="text/html; charset=ISO-8859-1" />
  <meta http-equiv="Content-Style-Type" content="text/css" />
  <meta name="GENERATOR" content="Quadralay WebWorks Publisher Professional Edition 7.0.5.1025" />
  <meta name="TEMPLATEBASE" content="WWH 3.0 Help Template" />
  <meta name="LASTUPDATED" content="02/20/03 12:36:52" />
  <title>MTS Support</title>
  <link rel="StyleSheet" href="document.css" type="text/css" />
  <link rel="StyleSheet" href="catalog.css" type="text/css" />
<script type="text/javascript" language="JavaScript1.2" src="wwhdata/common/context.js"></script>
  <script type="text/javascript" language="JavaScript1.2" src="wwhdata/common/towwhdir.js"></script>
  <script type="text/javascript" language="JavaScript1.2" src="wwhdata/common/wwhpagef.js"></script>

  <script type="text/javascript" language="JavaScript1.2">
   <!--
    // Set reference to top level help frame
    //
    var  WWHFrame = WWHGetWWHFrame("");
   // -->
  </script>
 </head>

 <body onLoad="WWHUpdate();">

 <blockquote>
<a name="wp541656"> </a><h1 class="pNewHTMLPageNoNum">
MTS Support
</h1>
<hr /><a name="wp529356"> </a><p class="pBody">
The Sybase Wire Protocol driver can take advantage of Microsoft Transaction Server (MTS) capabilities, specifically, the Distributed Transaction Coordinator (DTC). Refer to the help file of the &quot;MicroSoft Transaction Server SDK&quot; for details. 
</p>
<a name="wp529386"> </a><p class="pBody">
You can choose between Native OLE and XA protocol distributed transactions by using the DistributedTransactionModel connection string attribute documented in <a  href="Rase5.html#wp540679">Table&#160;2-1</a>.
</p>
<a name="wp529390"> </a><p class="pBody">
To enable distributed transaction in the Sybase server:
</p>
<div class="pSmartList1"><ol type="1" class="pSmartList1">
<a name="wp529391"> </a><div class="pSmartList1"><li>Assign the dtm_tm_role to each user who will participate in distributed transactions (who will log in to Adaptive Server). You can do this using the sp_role command. For example:</li></div><a name="wp529497"> </a><p class="pSyntaxEmbed">
sp_role &quot;grant&quot;, dtm_tm_role, <code><em>user_name</em></code>
</p>
<a name="wp529506"> </a><p class="pBodyIndent12pxBeforeAfter">
In the open string for resource managers, the specified username must have the dtm_tm_role.
</p>
<a name="wp529392"> </a><div class="pSmartList1"><li>Specify a default database other than the master for each user. Sybase cannot start distributed transactions in a master database.</li></div></ol></div>
 </blockquote>

 <hr />

<script type="text/javascript" language="JavaScript1.2">
   <!--
    document.write(WWHRelatedTopicsDivTag() + WWHPopupDivTag());
   // -->
  </script>

 </body>
</html>
